<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Быстрое умножение</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="../pandoc.css" type="text/css" />
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
  <link href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfjBggQFxAS4ilBAAACgElEQVRIx52VS0iUYRSGn/8fzbxMIYoRKSZKi2wGwo2FxRQZIlGbaGUF0b52LWbTLlx0W7VyEZiBWkE5mraRRrJFRUwolQw6zQTeuoiU423eFuk0M//nhJ7dd+Z7n/8932HOscgIgU0lR/Cxn3LKgGlijDJIkAgJiywhZMujVo0qrsyIa1St8shWFnmp/IooW0TkV6mMYuRVQCv6X6woIK+QQ16vkPP2M/WZICHVpyGEvCb5vE7olH6bEV6l1R4w3RpQkYoVNJcSWHsLIUt+rTpvLOuSELqihAmwKr8sgZBHE2aX5UKoRmNmDxPyCBtoodLU1m5yaADC9Jr7XkkLoCqNmPAx1eqqnqhAqEHfzB5GVGXTQLUJ/5xZznGcOuAtQbOHahpsfOQ5f5mng8McZAdnsVigkyUTIA8fGjZ561OpuiRJY6oR2qU35iKGbSqc4GU6qObYmstmYIrH5iIq0JIT+17lupU8BVUsVKsvJgdLtgnbxXZOJ091HAU+0W+0YCnGnvRUlCa+42OdbRHiA3CSbtyZ+q85RDMBfcxxjZKUf5uPO4wwzGsaMwFR1JZe1Jx8uuB4mBtC6LJzXLTZDLKYihziM+fJzfjQGfYC/XxMTy8yaDNEOLWBDznAIcdT7aMRiPI0PR1myGacnn+Zd7ygiUIHwEUjuUAnsdR0D+M20E7k7/knt5ki39guN9uAEPeIr6citIPrOsxQiC9hveIuLylkkgXyKUsR/2CAB8yyEzdhJiliN3aCmzwCCwSl3FfzDL9wYZFAuClJAcSZJoELALFKAWVYvVxkdm3NbDRUs0TqUM021jeU15s2w9YXSxKy9dWWRGx6uVpOyObW+x/B+LEV0hF3cAAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOS0wNi0wOFQxNjoyMzoxNiswMjowMLEfSBUAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTktMDYtMDhUMTY6MjM6MTYrMDI6MDDAQvCpAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC" rel="icon" type="image/x-icon" />
  
  <!-- Yandex.Metrika counter -->
  <script type="text/javascript">
     (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
     m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
     (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
  
     ym(53961409, "init", {
          clickmap:true,
          trackLinks:true,
          accurateTrackBounce:true,
          webvisor:true
     });
  </script>
  <noscript><div><img src="https://mc.yandex.ru/watch/53961409" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
  <!-- /Yandex.Metrika counter -->
</head>
<body>
<div id="header">
<h1 class="title">Быстрое умножение</h1>
</div>
<h1 id="быстрое-умножение">Быстрое умножение</h1>
<p>В конце 50-х годов, а быстрое преобразование Фурье только изобрели, но использовали только «по назначению» (для обработки сигналов, а не для умножения чисел).</p>
<p><a href="https://ru.wikipedia.org/wiki/%D0%9A%D0%BE%D0%BB%D0%BC%D0%BE%D0%B3%D0%BE%D1%80%D0%BE%D0%B2,_%D0%90%D0%BD%D0%B4%D1%80%D0%B5%D0%B9_%D0%9D%D0%B8%D0%BA%D0%BE%D0%BB%D0%B0%D0%B5%D0%B2%D0%B8%D1%87">Андрей Колмогоров</a> и несколько других пионеров компьютер саенса выдвинули «гипотезу <span class="math inline">\(n^2\)</span>» — что . Основания на то были — шумеры научились умножать в «в столбик» (сложение <span class="math inline">\(n\)</span> <span class="math inline">\(n\)</span>-значиных чисел) как минимум четыре тысячи лет назад, и за это время никто ничего быстрее не придумал.</p>
<p>Колмогоров уже собрал научный семинар с повесткой дня «давайте это всё уже докажем», на котором его аспирант. Аспиранта звали Анатолий Карацуба.</p>
<p>Алгоритм Карацубы имеет довольно значимое место в истории науки.</p>
<p>{M(n)=O(n^{2}).} M(n)=O(n^{2}). У Колмогорова была гипотеза, что нижняя оценка для {M(n)} M(n) при любом методе умножения есть также величина порядка {n^{2}} n^{2}. На правдоподобность «гипотезы {n^{2}} n^{2}» указывал тот факт, что метод умножения «в столбик» известен не менее четырёх тысячелетий (например, этим методом пользовались шумеры), и если бы был более быстрый метод умножения, то он, вероятно, уже был бы найден. Однако, в 1960 году Анатолий Карацуба[4][5][6][7] нашёл новый метод умножения двух n-значных чисел с оценкой сложности {M(n)=O(n^{<em>{2}3})} M(n)=O(n^{{</em>{2}3}}) и тем самым опроверг «гипотезу {n^{2}} n^{2}».</p>
<p>(Быстрое преобразование Фурье тогда уже изобрели, но к умножению чисел применять ещё не додумались.)</p>
<p>Можно представить себе какого-то грозного японца.</p>
<h2 id="мастер-теорема">Мастер-теорема</h2>
<p>Алгоритм Карацубы основывается на парадигме «разделяй-и-властвуй». Чтобы понять, почему его асимптотика именно такая, нам понадобится более мощная теорема, которая говорит об асимптотике большого класса «разделяек».</p>
<p><strong>Мастер-теорема.</strong> Пусть имеется рекуррента:</p>
<p><span class="math display">\[ T(n) = \begin{cases}
a T(\frac{n}{b}) + \Theta(n^c), &amp; n &gt; n_0
\\ \Theta(1),                   &amp; n \leq n_0
\end{cases} \]</span></p>
<p>Тогда:</p>
<ul>
<li><strong>A.</strong> Если <span class="math inline">\(c &gt; \log_b a\)</span>, то <span class="math inline">\(T(n) = \Theta(n^c)\)</span>.</li>
<li><strong>B.</strong> Если <span class="math inline">\(c = \log_b a\)</span>, то <span class="math inline">\(T(n) = \Theta(n^c \log n)\)</span>.</li>
<li><strong>C.</strong> Если <span class="math inline">\(c &lt; \log_b a\)</span>, то <span class="math inline">\(T(n) = \Theta(n^{\log_b a})\)</span>.</li>
</ul>
<hr />
<p><img width='600px' src='http://sereja.me/f/img/master-theorem.png'></p>
<hr />
<p><strong>Доказательство.</strong> Рассмотрим «дерево рекурсии» этого соотношения. В нём будет <span class="math inline">\(log_b n\)</span> уровней. На <span class="math inline">\(k\)</span>-том уровне будет <span class="math inline">\(a^k\)</span> вершин, каждая из которых будет стоить <span class="math inline">\((\frac{n}{b^k})^c\)</span> операций. Просуммируем значения во всех вершинах по всем уровням:</p>
<p><span class="math display">\[ T(n) = \sum_{k=0}^{\log_b n} a^k (\frac{n}{b^k})^c = n^c \sum_{k=0}^{\log_b n} (\frac{a}{b^c})^k \]</span></p>
<ul>
<li><strong>A.</strong> Если <span class="math inline">\(c &gt; \log_b a\)</span>, то <span class="math inline">\(\sum (\frac{a}{b^с})^k\)</span> это сумма убывающей геометрической прогрессии, которая не зависит от <span class="math inline">\(n\)</span> и просто равна какой-то константе. Значит, <span class="math inline">\(T(n) = \Theta(n^c)\)</span>.</li>
<li><strong>B.</strong> Если <span class="math inline">\(c = \log_b a\)</span>, то <span class="math display">\[\sum_{k=0}^{\log_b n} (\frac{a}{b^c})^k = \sum_{k=0}^{\log_b n} 1^k = \Theta(n^c \log_b n)\]</span></li>
<li><strong>C.</strong> Если <span class="math inline">\(c &lt; \log_b a\)</span>, то так как сумма прогрессии асимптотически эквивалентна своему старшему элементу,</li>
</ul>
<p><span class="math display">\[ n^c \sum_{k=0}^{\log_b n} (\frac{a}{b^c})^k = \Theta(n^c (\frac{a}{b^c})^{\log_b n}) = \Theta(n^c \cdot \frac{a^{\log_b n}}{n^c}) = \Theta(a^{\log_b n}) = \Theta(n^{\log_b a}) \]</span></p>
<p>Для более точных оценок асимптотики «мерджа» теорема ничего не говорит работает. Например, если мердж занимает <span class="math inline">\(O(n)\)</span></p>
<h2 id="алгоритм-карацубы">Алгоритм Карацубы</h2>
<p>Алгоритм Карацубы сводит задачу умножения двух чисел длины <span class="math inline">\(n\)</span> к возведению <span class="math inline">\(n\)</span>-значного числа в квадрат.</p>
<p>Зачем нам возведение в квадрат, если мы хотим умножать числа? Оказывается, это эквивалентные задачи.</p>
<h2 id="развитие-идеи">Развитие идеи</h2>
<p>То же самое можно применить матрицам.</p>
<p>Чемпионат идёт на пятые знаки после запятой. Возможность или невозможность умножения чисел за <span class="math inline">\(O(n^{1+\epsilon})\)</span> для произвольного <span class="math inline">\(\epsilon\)</span> ещё никто не доказал.</p>
</body>
</html>
